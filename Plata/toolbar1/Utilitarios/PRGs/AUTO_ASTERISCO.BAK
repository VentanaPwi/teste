LPARAMETERS tcTEXTO AS STRING, tnTAMANHO AS INTEGER, tnMODO AS INTEGER

IF TYPE('tcTEXTO') <> 'C'
	tcTEXTO	= ''
ENDIF
IF EMPTY(tcTEXTO)
	RETURN .F.
ENDIF

IF TYPE('tnTAMANHO') <> 'N'
	tnTAMANHO	= 0
ENDIF

IF TYPE('tnMODO') <> 'N'
	tnMODO = 0
ENDIF

IF EMPTY(tnTAMANHO) OR tnTAMANHO > 1000
	tnTAMANHO = 60
ENDIF 

LOCAL lcINPUT, lcFINAL, lcESQUERDA, lcDIREITA, lcLASTLINE, lcCABECALHO, lcMEIO, lcPOSCABECALHO, lcFIM AS STRING
STORE '' TO lcINPUT, lcFINAL, lcESQUERDA, lcDIREITA, lcLASTLINE, lcCABECALHO, lcMEIO, lcPOSCABECALHO, lcFIM 
lcINPUT = tcTEXTO

LOCAL lnTAMANHO, lnQT AS INTEGER
STORE 0 TO lnTAMANHO, lnQT

lnTAMANHO = tnTAMANHO
lnQT = ROUND((lnTAMANHO - LEN(ALLTRIM(lcINPUT))) / 2, 0)

ESPERANDO('Criando auto asterisco.')
FOR lnXI = 1 TO lnQT
	lcESQUERDA = lcESQUERDA + '*'
	lcDIREITA = lcDIREITA + '*'
ENDFOR

lcMEIO = lcESQUERDA + lcINPUT + lcDIREITA
FOR lnXI = 1 TO LEN(lcMEIO)
	lcCABECALHO = lcCABECALHO + '*'
ENDFOR

FOR lnXI = 1 TO LEN(lcMEIO)
	lcPOSCABECALHO = lcPOSCABECALHO + '*'
ENDFOR

FOR lnXI = 1 TO LEN(lcMEIO)
	lcFIM = lcFIM + '*'
ENDFOR

IF tnMODO == 1
	TEXT TO lcFINAL NOSHOW
	[[CABECALHO]]
	[[MEIO]]
	[[POSCABECALHO]]
	
	[[FIM]]
	ENDTEXT
ELSE
	TEXT TO lcFINAL NOSHOW
	[[MEIO]]

	[[FIM]]
	ENDTEXT
ENDIF

lcFINAL	= STRTRAN( lcFINAL, '[[CABECALHO]]', lcCABECALHO )
lcFINAL	= STRTRAN( lcFINAL, '[[MEIO]]', lcMEIO )
lcFINAL	= STRTRAN( lcFINAL, '[[POSCABECALHO]]', lcPOSCABECALHO )
lcFINAL	= STRTRAN( lcFINAL, '[[FIM]]', lcFIM )

=FIMESPERANDO()

_CLIPTEXT = lcFINAL
MESSAGEBOX('COPIADO PARA O CLIPTEXT.', 0, 'Auto *')