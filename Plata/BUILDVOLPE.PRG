CLOSE ALL
CLEAR ALL
CLEAR PROGRAM

** LIMPANDO LIXO DAS CLASSES
** ROTINA NECESSÁRIA PARA REFOX FUNCIONAR COM SUCESSO

WAIT WINDOW 'Pack PWICLASS.VCX' NOWAIT NOCLEAR
USE SYSTEM\PWICLASS.VCX EXCLUSIVE
PACK
USE

WAIT WINDOW 'Pack GDIPLUSX.VCX' NOWAIT NOCLEAR
USE SYSTEM\GDIPLUSX.VCX EXCLUSIVE
PACK
USE

WAIT WINDOW 'Pack RESCLASS.VCX' NOWAIT NOCLEAR
USE SYSTEM\RESCLASS.VCX EXCLUSIVE
PACK
USE

WAIT WINDOW 'Pack SYSTEM.VCX' NOWAIT NOCLEAR
USE SYSTEM\SYSTEM.VCX EXCLUSIVE
PACK
USE

WAIT WINDOW 'Pack ZIPCLASS.VCX' NOWAIT NOCLEAR
USE SYSTEM\ZIPCLASS.VCX EXCLUSIVE
PACK
USE

WAIT WINDOW 'Pack PWINATIVE.VCX' NOWAIT NOCLEAR
USE SYSTEM\PWINATIVE.VCX EXCLUSIVE
PACK
USE

WAIT WINDOW 'Pack FOXCHARTS.VCX' NOWAIT NOCLEAR
USE SYSTEM\FOXCHARTS.VCX EXCLUSIVE
PACK
USE

* PEGANDO VERSÃO DO MENURAIZ
LOCAL lcMENU, lcBUSCA, lcVERSAO AS String
LOCAL lnAT AS Integer

lcMENU		= FILETOSTR('MENURAIZ.PRG')
lcBUSCA		= "VERSAO			= '"
lnAT		= AT(lcBUSCA,lcMENU)+LEN(lcBUSCA)
lcVERSAO	= SUBSTR(lcMENU,lnAT,9)

* COMPILA MENURAIZ
COMPILE MENURAIZ.PRG

* ALTERANDO VERSÃO DO EXECUTÁVEL
MODIFY PROJECT VOLPEWAW SAVE NOSHOW
APPLICATION.ActiveProject.VersionNumber = lcVERSAO
APPLICATION.ActiveProject.Close()

* GERANDO NOVO EXECUTÁVEL
WAIT WINDOW 'Compilando EXE' NOWAIT NOCLEAR

BUILD EXE VOLPEWAW_NO_REFOX.EXE FROM VOLPEWAW

WAIT CLEAR

MESSAGEBOX('Executável VOLPEWAW criado com sucesso!',0,'Sucesso!')